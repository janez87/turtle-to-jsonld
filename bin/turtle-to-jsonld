#!/usr/bin/env node
/* -*- mode: Javascript -*-

turtle-to-jsonld
Copyright 2013 Kuno Woudt <kuno@frob.nl>

turtle-to-jsonld is licensed under copyleft-next version 0.3.0, see
LICENSE.txt for more information.

*/

var fs = require ('fs');
var jsonld = require ('jsonld');
var turtle_to_jsonld = require ('../lib/turtle-to-jsonld');

function help ()
{
    console.log ("turtle-to-jsonld");
    console.log ("Copyright 2013 Kuno Woudt <kuno@frob.nl>");
    console.log ("License: copyleft-next 0.3.0");
    console.log ("");
    console.log ("Usage: turtle-to-jsonld <filename> [context]");
};

function main (filename, context)
{
    fs.readFile(filename, "utf-8", function (err, data) {

        turtle_to_jsonld.compactFromTurtle (data, context, function (err, output) {
            if (err) {
                console.error ("ERROR: ", err);
                process.exit(1);
            }
            else
            {
                console.log (JSON.stringify (output, null, "    "));
            }
        });
    });
};

if (process.argv[2] === undefined || process.argv[2] === '--help')
{
    help ();
}
else
{
    context = null;
    if (process.argv.length > 3) {
        var buffer = fs.readFileSync(process.argv[3])
        context = JSON.parse(buffer.toString());
    }

    main (process.argv[2], context);
}
